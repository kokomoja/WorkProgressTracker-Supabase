<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Admin | PCG Work Tracker</title>
    <link rel="stylesheet" href="style.css" />
    <script src="public.config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <header class="topbar">
      <div class="left">
        <h1>üõ†Ô∏è Admin Dashboard</h1>
      </div>
      <div class="right">
        <div class="user-info">
          <span id="adminInfo">üëë admin</span>
          <a class="btn" href="admin_setting.html">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
          <button id="logout" class="btn danger">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
      </div>
    </header>

    <!-- üß© KPI + Chart -->
    <section class="wrap">
      <div class="summary-grid">
        <div class="card">
          <div class="kpi-label">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</div>
          <div id="kpiTodo" class="kpi-value">0</div>
        </div>
        <div class="card">
          <div class="kpi-label">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
          <div id="kpiDoing" class="kpi-value">0</div>
        </div>
        <div class="card">
          <div class="kpi-label">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
          <div id="kpiDone" class="kpi-value">0</div>
        </div>
      </div>

      <div class="card" style="height: 320px">
        <canvas id="statusChart"></canvas>
      </div>
    </section>

    <!-- üß© ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô -->
    <section class="card" style="grid-column: 1/-1">
      <h2>‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>

      <div class="admin-top-buttons">
        <button id="btnAddTask" class="btn primary">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
        <div id="addTaskCollapse" style="display: none">
          <form id="addTaskForm">
            <div>
              <label>‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô (Task ID)</label>
              <input id="newTaskCode" placeholder="‡πÄ‡∏ä‡πà‡∏ô T001" required />
            </div>
            <div>
              <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</label>
              <input id="newTaskName" required />
            </div>
            <div>
              <div>
                <label>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
                <select id="newAssignee" required>
                  <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö --</option>
                </select>
              </div>
            </div>
            <div>
              <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
              <input id="newStartDate" type="date" />
            </div>
            <div>
              <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
              <input id="newEndDate" type="date" />
            </div>
            <div>
              <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤ (%)</label>
              <input
                id="newProgress"
                type="number"
                min="0"
                max="100"
                value="0"
              />
            </div>
            <div>
              <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
              <select id="newStatus">
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</option>
                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                <option value="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</option>
              </select>
            </div>
            <div style="grid-column: 1/-1">
              <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
              <textarea
                id="newRemark"
                placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."
              ></textarea>
            </div>
            <div class="form-actions">
              <button type="button" id="btnCancelAdd" class="btn ghost">
                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
              </button>
              <button type="submit" class="btn primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
          </form>
        </div>
      </div>

      <!-- ‚úÖ Filter Bar -->
      <form id="filterForm" class="filter-row">
        <div class="filter-bar">
          <label for="fStatus">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>
          <select id="fStatus">
            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
            <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</option>
            <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
            <option value="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</option>
          </select>
        </div>
      </form>
    </section>

    <!-- üß© ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô -->
    <section class="wrap">
      <div class="card">
        <div class="table-wrap">
          <table id="taskTable">
            <thead>
              <tr>
                <th style="width: 36px">
                  <input type="checkbox" id="chkAll" />
                </th>
                <th data-sort="id">‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô ‚•Æ</th>
                <th data-sort="name">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô ‚•Æ</th>
                <th data-sort="assignee">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö ‚•Æ</th>
                <th data-sort="startDate">‡πÄ‡∏£‡∏¥‡πà‡∏° ‚•Æ</th>
                <th data-sort="endDate">‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î ‚•Æ</th>
                <th data-sort="progress">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤ ‚•Æ</th>
                <th data-sort="status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚•Æ</th>
                <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                <th data-sort="lastUpdate">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚•Æ</th>
                <th style="min-width: 120px">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
              </tr>
            </thead>
            <tbody id="taskTbody"></tbody>
          </table>
        </div>

        <div class="row center gap" style="margin-top: 12px">
          <button class="btn ghost" id="prevPage">‚¨Ö</button>
          <span id="pageInfo">‡∏´‡∏ô‡πâ‡∏≤ 1/1</span>
          <button class="btn ghost" id="nextPage">‚û°</button>
          <div class="flex-spacer"></div>
          <label>‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤:</label>
          <select id="pageSize" style="width: 90px">
            <option>10</option>
            <option>20</option>
            <option>50</option>
            <option>100</option>
          </select>
        </div>
      </div>
    </section>

    <!-- üß© Modal ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
    <dialog id="taskModal" class="modal">
      <form id="taskForm" method="dialog">
        <h3 id="modalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</h3>
        <input type="hidden" id="taskId" />
        <div class="grid2 gap">
          <div>
            <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</label>
            <input id="taskName" required />
          </div>
          <div>
            <div>
              <label>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
              <select id="editAssignee" required>
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö --</option>
              </select>
            </div>
          </div>
          <div>
            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
            <input id="startDate" type="date" />
          </div>
          <div>
            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
            <input id="endDate" type="date" />
          </div>
          <div>
            <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤ (%)</label>
            <input id="progress" type="number" min="0" max="100" value="0" />
          </div>
          <div>
            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
            <select id="status" required>
              <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</option>
              <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
              <option value="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</option>
            </select>
          </div>
          <div class="col-span2">
            <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
            <textarea
              id="remark"
              class="remark"
              rows="2"
              placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."
            ></textarea>
          </div>
        </div>
        <div class="row right gap" style="margin-top: 14px">
          <button type="button" id="btnCancel" class="btn ghost">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" class="btn primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
      </form>
    </dialog>

    <script>
      const API_BASE =
        (window.APP_CONFIG && window.APP_CONFIG.API_BASE) || "/api";
    </script>
    <script src="app_admin.js"></script>
  </body>
</html>
